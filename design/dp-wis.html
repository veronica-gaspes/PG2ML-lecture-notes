
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Maximum independent set for weighted path graphs &#8212; Python - a gateway to machine learning</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The knapsack problem" href="dp-knapsack.html" />
    <link rel="prev" title="Fibonacci numbers" href="dp-fib.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/panda.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python - a gateway to machine learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   About these lecture notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Overview of the course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/overview.html">
   Overview
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Algorithms and their execution time behaviour
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../algs/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../algs/algs-lecture.html">
   Lecture 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/loops.html">
     Understanding
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/primes.html">
     Prime numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/recursion.html">
     Understanding recursion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/mul.html">
     Three algorithms for integer multiplication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/theory-exercises-1.html">
     Theory exercises 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/programming-exercises-1.html">
     Programming exercises 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/programming-solutions-1.html">
     Solutions to programming exercises 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../algs/execution-time.html">
   Lecture 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/et.html">
     Order and sorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algs/math-and-experiments.html">
     Measuring and estimating execution time behaviour
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Algorithm design paradigms
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dc-intro.html">
   Lecture 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dc-mergesort.html">
     Mergesort
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dc-inversions.html">
     Counting inversions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="dp-intro.html">
   Lecture 4
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="dp-fib.html">
     Fibonacci numbers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Maximum independent set for weighted path graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dp-knapsack.html">
     The knapsack problem
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data structures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ds/intro.html">
   Data structures
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ds/lecture5.html">
   Lecture 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ds/lists.html">
     Lists in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ds/classes.html">
     Classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ds/queues.html">
     Queues
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/design/dp-wis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdesign/dp-wis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/design/dp-wis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-examples">
   Definitions and examples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-statement">
   Problem statement
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-an-algorithm">
   Finding an algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-can-we-identify-the-small-number-of-subproblems">
     How can we identify
     <em>
      the small number of subproblems?
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Maximum independent set for weighted path graphs</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-examples">
   Definitions and examples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-statement">
   Problem statement
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-an-algorithm">
   Finding an algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-can-we-identify-the-small-number-of-subproblems">
     How can we identify
     <em>
      the small number of subproblems?
     </em>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="maximum-independent-set-for-weighted-path-graphs">
<h1>Maximum independent set for weighted path graphs<a class="headerlink" href="#maximum-independent-set-for-weighted-path-graphs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definitions-and-examples">
<h2>Definitions and examples<a class="headerlink" href="#definitions-and-examples" title="Permalink to this headline">¶</a></h2>
<p>A path graph looks like a line of dots connected by line segments. The dots are called vertices or nodes. The line segments are called edges. Here is an example:</p>
<div class="math notranslate nohighlight">
\[\bigcirc \rule[2pt]{1cm}{0.4pt} \bigcirc \rule[2pt]{1cm}{0.4pt} \bigcirc \rule[2pt]{1cm}{0.4pt} \bigcirc \rule[2pt]{1cm}{0.4pt}  \bigcirc \rule[2pt]{1cm}{0.4pt} \bigcirc \]</div>
<p>When we associate a weight or cost with the nodes we cal it a weighted path graph. We can then use an array to describe a path graph: the indices are the <em>names</em> of the nodes and the content is the weight of the index node.</p>
<p>A path graph with as above would have nodes 0, 1, 2, 3, 4 and 5. A weighted variant can be given by the array</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>to mean that node 0 has weight 6, node 1 has weight 10, nodes 2, 3 and 4 have weight 1 and node 5 has weight 2.</p>
<p>Now that we understand what a weighted path graph is, lets look at <em>independent sets</em>.</p>
<p>An independent set is a set of nodes that do not share an edge. Here are <strong>some</strong> independent sets for the path graph we are using:</p>
<div class="math notranslate nohighlight">
\[ \emptyset,  \{0\},  \{1\}, \{2\}, \{3\}, \{4\}, \{5\}, \{0,2\}, \{0,3\}, \{1,3,5\}\]</div>
<p>There are of course more that you might try to find.</p>
<p>The following is <strong>not</strong> an independent set: <span class="math notranslate nohighlight">\( \{0,2,3\} \)</span>. This is because 2 and 3 are endpoints of the same edge.<br />
Given an independent set in a weighted path graph, we can calculate the total weight of the set by adding the weights of the nodes in the set. In our example</p>
<ul class="simple">
<li><p>the independent set <span class="math notranslate nohighlight">\( \emptyset \)</span> has weight 0</p></li>
<li><p>the independent set <span class="math notranslate nohighlight">\( \{0\} \)</span> has weight 6</p></li>
<li><p>the independent set <span class="math notranslate nohighlight">\(\{1,3,5\}\)</span> has weight 13</p></li>
</ul>
</div>
<div class="section" id="problem-statement">
<h2>Problem statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>Given a weighted path graph find an independent set of maximum weight. All weights are <span class="math notranslate nohighlight">\( &gt; 0\)</span>.</p>
</div>
<div class="section" id="finding-an-algorithm">
<h2>Finding an algorithm<a class="headerlink" href="#finding-an-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The book  <a class="reference external" href="http://algorithmsilluminated.org">Algorithms Illuminated</a> discusses this problem in detail in Chapter 16 in Part 3. Among other things it discusses two approaches, both of which fail to design a correct algorithm. Finally it makes an attempt using Dynamic programming and that is what we will follow here.</p>
<p>Here is the sketch of the paradigm once more:</p>
<ol class="simple">
<li><p>Identify a relatively small number of subproblems.</p></li>
<li><p>Show how to quickly and correctly solve <em>larger</em> problems given solutions to <em>smaller</em> problems.</p></li>
<li><p>Show how to quickly and correctly infer the final solution from the solutions to all the subproblems.</p></li>
</ol>
<blockquote>
<div><p>The algorithm you obtain is to systematically solve all the subproblems one by one, working from smallest to largest and extract the final solution from the solutions to the subproblems.</p>
</div></blockquote>
<div class="section" id="how-can-we-identify-the-small-number-of-subproblems">
<h3>How can we identify <em>the small number of subproblems?</em><a class="headerlink" href="#how-can-we-identify-the-small-number-of-subproblems" title="Permalink to this headline">¶</a></h3>
<p>We can start by assuming that we have a solution for a given size and try to see what components, in terms of solutions to smaller problems it can have. *<em>Notice that we do not look at the input size but at how the solution might look like!</em></p>
<p>Consider the example, and say that we have a solution for the whole path graph: we have an independent set <span class="math notranslate nohighlight">\(S\)</span> of maximum weight for the whole path graph.</p>
<p>We do not know much about this set <span class="math notranslate nohighlight">\(S\)</span>!</p>
<p>But, given that we cannot have the two last nodes in the set and that the weights are positive, the set will either include the last node (node 5) or it will not. If not, it will include the next to last (node 4)! If it does,  it will not include the next to last! So, lets consider these two cases:</p>
<ul class="simple">
<li><p>node 5 belongs to <span class="math notranslate nohighlight">\(S\)</span>. But in this case node 4 cannot belong to <span class="math notranslate nohighlight">\(S\)</span> so in some way there has to be a solution for the graph with nodes up to node 3 (remove 2 nodes from the path graph) that can be used to form our solution. We take this solution and add node 5 with its weight.</p></li>
<li><p>node 5 does not belong to <span class="math notranslate nohighlight">\(S\)</span>. Then, the solution is the same as the solution for the smaller graph upto node 4!</p></li>
</ul>
<p>So, we pick two smaller subproblems: the path graph without the last node (P1) and the path graph without the two last nodes (P2)</p>
<p>How can we use these two to form a solution for the whole path graph? Well, it depends on the weight of the last node. Say that the solution for P1 has total weight W1 and the solution for P2 has total weight W2.</p>
<ul class="simple">
<li><p>If W2 + weight of final node  <span class="math notranslate nohighlight">\(&gt;\)</span> W1 we use the solution for P2 and add the last node with its weight.</p></li>
<li><p>If not, we use the solution for P1 (we do not use the last node in the solution).</p></li>
</ul>
<p>If we do this from the smallest path graphs that form the path graph in our problem until we have all the nodes in the graph, we just need to take the solution for the longets path graph!</p>
<p>Let’s look at the example, starting with the smallest path graph and building the solutions for the longer and longer path graphs using these ideas:</p>
<ol>
<li><p>The solution for the path graph with only node 0 is the independent set <span class="math notranslate nohighlight">\({0}\)</span> with weight 6.</p></li>
<li><p>The solution for the path graph with nodes 0 and 1 can only have one node (it has to be an independent set!). So, it will pick node 0 or node 1, the one with highest weight. In our case the solution is <span class="math notranslate nohighlight">\({1}\)</span> with weight 10.</p></li>
<li><p>The solution for the path graph with nodes 0, 1 and 2 is found by picking the best between:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a) The solution for the path graph 0, 1: weight 10

 b) The solution for the path graph 0 and the node 2: weight 6 + 1
</pre></div>
</div>
<p>We keep the same solution as for 0, 1 with weight 10.</p>
</li>
<li><p>The solution for the path with nodes 0, 1, 2, 3 is found by picking the best between:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a)  The solution for path graph 0, 1, 2: weight 10

 b)  The solution for path graph 0, 1 and node 3: weight 10 + 1
</pre></div>
</div>
<p>We take the solution for path graph 0, 1 and add node 3: weight 10 + 1</p>
</li>
<li><p>The solution for the path with nodes 0, 1, 2, 3, 4 is found by picking the best between:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a)  The solution for path graph 0, 1, 2, 3: weight 11
 
 b)  The solution for path graph 0, 1, 2 and node 4: weight 10 + 1
</pre></div>
</div>
<p>They are the same! We could pick any of them. Both have weight 11.</p>
</li>
<li><p>The solution for the path with nodes 0, 1, 2, 3, 4, 5 is found by picking the best between:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a)  The solution for path graph 0, 1, 2, 3, 4: weight 11
 
 b)  The solution for path graph 0, 1, 2, 3 and node 5: weight 11 + 2
</pre></div>
</div>
<p>We take the solution for path graph 0, 1, 2, 3 and add node 5: weight 11 + 2.</p>
</li>
</ol>
<p>The solution to the problem has weight 13 and we can reconstruct it from the back: it uses node 5 (and then it does not use node 4) so we go to the solution for node 3: it uses node 3 (and then it does not use node 2) so we go to the solution for node 1: it uses node 1 (and then it does not use node 0). So: the independent set of with weight 13 is <span class="math notranslate nohighlight">\(\{1, 3, 5\}\)</span></p>
<p>Again, as in Fibonacci, we see the need for an array that we start filling in using the weights of the nodes in the path graph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># wpg is a weighted path graph given as an array: the indices are the nodes and the elements are the weights.</span>

<span class="k">def</span> <span class="nf">dp_wis</span><span class="p">(</span><span class="n">wpg</span><span class="p">):</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wpg</span><span class="p">)</span>
    <span class="n">solution_weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    
    <span class="c1"># For a path graph with only one node the solution uses that node!</span>
    <span class="n">solution_weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># For a path graph with two nodes, only one can be in the independent set: the one with highest weight</span>
    <span class="k">if</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      
    <span class="c1"># In all other cases pick the best between the solution for the path graph with one less node</span>
    <span class="c1"># or the solution fot the path graph with 2 less nodes and add the last node.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> 
                                  <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">wpg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="c1"># Finally, the solution is the last element!</span>
    <span class="k">return</span> <span class="n">solution_weights</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dp_wis</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the example in the book:</span>
<span class="n">dp_wis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<p>Now we want to add the <em>reconstruction</em>: we not only want the weight of the solution, we also want the independent set!</p>
<p>In the book the algorithm uses a <em>set</em> <span class="math notranslate nohighlight">\(S\)</span> to collect the nodes of the independent set. We do the same in Python even if we have not yet discussed sets. We will touch on sets in the lecture notes for data structures! For the moment we just use it. Here is what you have to know:</p>
<ul class="simple">
<li><p>You can create the empty set using <code class="docutils literal notranslate"><span class="pre">set()</span></code></p></li>
<li><p>You can add elements <code class="docutils literal notranslate"><span class="pre">e</span></code> to a set <code class="docutils literal notranslate"><span class="pre">s</span></code> by doing <code class="docutils literal notranslate"><span class="pre">s.add(e)</span></code></p></li>
</ul>
<p>So, here is the algorithm that calculates the weight of the independent set with maximum weight in a weighted path graph <strong>and</strong> forms the independent set with that weight (and you see why we cannot get rid of the array as we did in Fibonacci!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And now with the re-construction steps:</span>

<span class="k">def</span> <span class="nf">dp_wis_with_reconstruction</span><span class="p">(</span><span class="n">wpg</span><span class="p">):</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wpg</span><span class="p">)</span>
    <span class="n">solution_weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    
    <span class="c1"># For a path graph with only one node the solution uses that node!</span>
    <span class="n">solution_weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># For a path graph with two nodes, only one can be in the independent set: the one with highest weight</span>
    <span class="k">if</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">wpg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      
    <span class="c1"># In all other cases pick the best between the solution for the path graph with one less node</span>
    <span class="c1"># or the solution fot the path graph with 2 less nodes and add the last node.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> 
                                  <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">wpg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Finally, the solution is the last element!</span>
    
    <span class="c1"># Reconstruction ()</span>
    <span class="n">wis</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">solution_weights</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">wpg</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wis</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span>
            
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">wis</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
    <span class="c1"># the set and the weight</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">wis</span><span class="p">,</span> <span class="n">solution_weights</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dp_wis_with_reconstruction</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({1, 3, 5}, 13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the example in the book:</span>
<span class="n">dp_wis_with_reconstruction</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({1, 3}, 8)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./design"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="dp-fib.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Fibonacci numbers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="dp-knapsack.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The knapsack problem</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Veronica Gaspes<br/>
    
        &copy; Copyright none.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>